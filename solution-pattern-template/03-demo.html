<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>See the Solution in Action :: Solution Patterns for Cloud Native Architectures</title>
    <link rel="canonical" href="https://redhat-solution-patterns.github.io/solution-patterns/solution-pattern-template/03-demo.html">
    <link rel="prev" href="02-architecture.html">
    <link rel="next" href="04-conclusion.html">
    <meta name="generator" content="Antora 3.0.0">
    <link rel="stylesheet" href="../_/css/site.css">
<link rel="icon" href="../_/img/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-CTST6WY4MT"></script>
<script>function gtag() { dataLayer.push(arguments) }; window.dataLayer = window.dataLayer || []; gtag('js', new Date()); gtag('config', 'G-CTST6WY4MT')</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" style="font-size: 20px; color: white"
        href="https://redhat-solution-patterns.github.io/solution-patterns">
        <img src="../_/img/logo.png" height="35px" alt="Solution Patterns">&nbsp; Solution Patterns for Cloud Native Architectures</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Architectures &amp; Patterns</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://www.redhat.com/architect/portfolio/" target="_blank">Portfolio Architecture&nbsp; </a>
            <a class="navbar-item" href="https://redhat-solution-patterns.github.io/solution-patterns/patterns.html"  target="_blank">Solution Patterns </a>
            <a class="navbar-item" href="https://validatedpatterns.io/" target="_blank">Validated Patterns&nbsp;</a>
            <a class="navbar-item" href="https://catalog.redhat.com/solutions" target="_blank">Ecosystem Solutions&nbsp;</a>
          </div>
        </div>

        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Resources</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" target="_blank" href="https://developers.redhat.com">Red Hat Developers</a>
            <a class="navbar-item" target="_blank" href="https://developers.redhat.com/app-dev-platform">App Dev Platform</a>
            <a class="navbar-item" target="_blank" href="https://www.redhat.com/en/products/application-foundations">Red Hat Application Services</a>
          </div>
        </div>

          <a class="navbar-item" target="_blank" href="https://github.com/redhat-solution-patterns/redhat-solution-patterns.github.io/issues">Feedback</a>
          <a class="navbar-item" target="_blank" href="https://redhat-solution-patterns.github.io/solution-patterns/contributors-guide.html">Contribute</a>

      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="solution-pattern-template" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html" class=" query-params-link">Secure Local AI Models</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">1. Home page</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="index.html#use-cases">1.1 Use cases</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="index.html#_the_story_behind_this_solution_pattern">1.2 The story behind this solution pattern</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="index.html#_the_solution">1.3 The solution</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="02-architecture.html">2. Architecture</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-architecture.html#tech_stack">2.1. Technology stack</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-architecture.html#in_depth">2.2. An in-depth look at the solution&#8217;s architecture</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-architecture.html#more_tech">2.3. More about the technology stack</a>
  </li>
</ul>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="03-demo.html">3. See the Solution in Action</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#_demonstration">3.1. Demonstration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#_before_getting_started">3.2. Pre-requisites</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#_getting_started">3.3. Getting started</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#_ai_model_deployment_with_instructlab">3.4. AI model deployment with InstructLab</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#_public_skupper_deployment">3.5. Public Skupper deployment</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#_private_skupper_deployment">3.6. Private Skupper deployment</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#_deploying_instructlab_chatbot">3.7. Deploying InstructLab Chatbot</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#_interacting_with_the_chatbot">3.8. Interacting with the chatbot</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#_considerations">3.9. Considerations</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="04-conclusion.html">4. Conclusion</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="developer-resources.html">5. Developer Resources</a>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-text"><a href="https://redhat-solution-patterns.github.io/solution-patterns/patterns.html" target="_blank" rel="noopener">Explore Red Hat Solution Patterns</a></span>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Secure Local AI Models</span>
    <span class="version">master</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Secure Local AI Models</span>
      <ul class="versions">
        <li class="version is-current">
          <a href="index.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Secure Local AI Models</a></li>
    <li><a href="03-demo.html">3. See the Solution in Action</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/redhat-solution-patterns/solution-pattern-rhsi-ilab/edit/main/documentation/modules/ROOT/pages/03-demo.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">See the Solution in Action</h1>
<div class="sect1">
<h2 id="_demonstration"><a class="anchor" href="#_demonstration"></a>Demonstration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>References:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/instructlab">Commands extract from the InstructLab project</a></p>
</li>
<li>
<p><a href="https://developers.redhat.com/blog/2024/06/12/getting-started-instructlab-generative-ai-model-tuning#model_alignment_and_training_with_instructlab">Getting started with InstructLab: Generative AI model tuning</a></p>
</li>
<li>
<p><a href="https://github.com/instructlab/instructlab/blob/main/README.md#-installing-ilab">InstructLab installation guide</a></p>
</li>
<li>
<p><a href="https://github.com/rafaelvzago/ilab-client">ILAB Frontend chatbot</a></p>
</li>
<li>
<p><a href="https://developers.redhat.com">Red Hat Developer</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_concepts_and_commands_used_in_the_demonstration"><a class="anchor" href="#_concepts_and_commands_used_in_the_demonstration"></a>Concepts and Commands Used in the Demonstration</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Please make sure to explain what each Skupper command does the first time you use it, especially for people unfamiliar with Skupper. The following commands should be explained:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>skupper init</code></strong>: Initializes the Skupper network, setting up the necessary components to enable secure communication between services.</p>
</li>
<li>
<p><strong><code>skupper expose</code></strong>: Exposes a local service through the Skupper network, allowing it to be accessed from other Skupper-connected sites.</p>
</li>
<li>
<p><strong><code>skupper token</code></strong>: Generates a connection token that can be used by other sites to link to the Skupper network, ensuring secure communication.</p>
</li>
<li>
<p><strong><code>skupper link</code></strong>: Establishes a secure link between two Skupper sites using the token created by <code>skupper token</code>.</p>
</li>
<li>
<p><strong><code>skupper service status</code></strong>: Displays the status of services exposed through Skupper, showing what is accessible and how it’s connected within the network.</p>
</li>
<li>
<p><strong><code>ilab download</code></strong>: Downloads the model to be used by the chatbot.</p>
</li>
<li>
<p><strong><code>ilab model serve</code></strong>: Starts the server that will be responsible for receiving the user input, sending it to the LLaMA3 model, and sending the response back to the user.</p>
</li>
<li>
<p><strong><code>ilab model chat</code></strong>: Starts the chatbot, allowing the user to interact with it.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_demonstration"><a class="anchor" href="#_demonstration"></a>Run the demonstration</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_before_getting_started"><a class="anchor" href="#_before_getting_started"></a>Before getting started</h3>
<div class="paragraph">
<p>To set up the demonstration, you need to have the following prerequisites:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Access to an OpenShift cluster with the Skupper and InstructLab installed.</p>
</li>
<li>
<p>A server running the InstructLab chat model.</p>
</li>
<li>
<p>Access to a terminal to run the commands.</p>
</li>
<li>
<p>Access to a web browser to interact with the chatbot.</p>
</li>
<li>
<p>oc client installed and configured to access the OpenShift cluster.</p>
</li>
<li>
<p>skupper client installed and configured to access the OpenShift cluster.</p>
</li>
<li>
<p>Podman installed to run the private Skupper.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_ai_model_deployment_with_instructlab"><a class="anchor" href="#_ai_model_deployment_with_instructlab"></a>AI Model Deployment with InstructLab</h3>
<div class="paragraph">
<p>The first step is to deploy the InstructLab chat model in the InstructLab site. The InstructLab chat model will be responsible for receiving the user input and sending it to the LLaMA3 model. The response from the LLaMA3 model will be sent back to the user. This is based on the article: <a href="https://developers.redhat.com/blog/2024/06/12/getting-started-instructlab-generative-ai-model-tuning#model_alignment_and_training_with_instructlab">Getting Started with InstructLab for Generative AI Model Tuning</a>.</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell script hljs" data-lang="shell script">mkdir instructlab &amp;&amp; cd instructlab
sudo dnf install gcc gcc-c++ make git python3.11 python3.11-devel
python3.11 -m venv --upgrade-deps venv
source venv/bin/activate
pip install instructlab</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>The <code>mkdir instructlab &amp;&amp; cd instructlab</code> command is used to create a directory called <code>instructlab</code> and navigate to it.</p>
</li>
<li>
<p>The <code>sudo dnf install gcc gcc-c++ make git python3.11 python3.11-devel</code> command is used to install the necessary dependencies for InstructLab.</p>
</li>
<li>
<p>The <code>python3.11 -m venv --upgrade-deps venv</code> command is used to create a virtual environment called <code>venv</code> for InstructLab.</p>
</li>
<li>
<p>The <code>source venv/bin/activate</code> command is used to activate the virtual environment.</p>
</li>
<li>
<p>The <code>pip install instructlab</code> command is used to install InstructLab in the virtual environment.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_initialize_the_instructlab_configuration"><a class="anchor" href="#_initialize_the_instructlab_configuration"></a>Initialize the InstructLab Configuration</h3>
<div class="paragraph">
<p>Now it&#8217;s time to initialize the InstructLab configuration. The <code>ilab config init</code> command is used to initialize the InstructLab configuration, creating the <code>config.yaml</code> file with the default configuration. Run the following command:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell script hljs" data-lang="shell script">ilab config init</code></pre>
</div>
</div>
<div class="paragraph">
<p>The output will be similar to the following, with the user being prompted to provide the necessary values to initialize the environment:</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell script hljs" data-lang="shell script">Welcome to InstructLab CLI. This guide will help you to setup your environment.
Please provide the following values to initiate the environment [press Enter for defaults]:
Path to taxonomy repo [/home/user/.local/share/instructlab/taxonomy]:
Path to your model [/home/user/.cache/instructlab/models/merlinite-7b-lab-Q4_K_M.gguf]:
Generating `/home/user/.config/instructlab/config.yaml` and `/home/user/.local/share/instructlab/internal/train_configuration/profiles`...
Please choose a train profile to use.
Train profiles assist with the complexity of configuring specific GPU hardware with the InstructLab Training library.
You can still take advantage of hardware acceleration for training even if your hardware is not listed.
[0] No profile (CPU, Apple Metal, AMD ROCm)
[1] Nvidia A100/H100 x2 (A100_H100_x2.yaml)
[2] Nvidia A100/H100 x4 (A100_H100_x4.yaml)
[3] Nvidia A100/H100 x8 (A100_H100_x8.yaml)
[4] Nvidia L40 x4 (L40_x4.yaml)
[5] Nvidia L40 x8 (L40_x8.yaml)
[6] Nvidia L4 x8 (L4_x8.yaml)
Enter the number of your choice [hit enter for no profile] [0]:
No profile selected - any hardware acceleration for training must be configured manually.
Initialization completed successfully, you're ready to start using `ilab`. Enjoy!</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>The <code>ilab config init</code> command is used to initialize the InstructLab configuration, creating the <code>config.yaml</code> file with the default configuration.</p>
</li>
<li>
<p>The user is prompted to provide the necessary values to initialize the environment, such as the path to the taxonomy repo and the path to the model.</p>
</li>
<li>
<p>After running ilab config init your directories will look like the following on a Linux system:</p>
<div class="ulist">
<ul>
<li>
<p>~/.cache/instructlab/models/ (1)</p>
</li>
<li>
<p>~/.local/share/instructlab/datasets (2)</p>
</li>
<li>
<p>~/.local/share/instructlab/taxonomy (3)</p>
</li>
<li>
<p>~/.local/share/instructlab/checkpoints (4)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>(1) Directory where the models are stored.
(2) Directory where the datasets are stored.
(3) Directory where the taxonomy is stored.
(4) Directory where the checkpoints are stored.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To enable external access to your model, please modify the <code>config.yaml</code> file, located into your <code>instructlab</code> directory:  <code>~/.config/instructlab/config.yaml</code>. This change needs to be done under the <code>serve</code> section, as shown below:</p>
</div>
<div class="listingblock source">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">host_port: 0.0.0.0:8000</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>The `host_port: The IP address and port where the model will be exposed. In this case, the model will be exposed on all interfaces.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Before starting the server, download the model to be used by the chatbot. The <code>ilab download</code> command is used to download the model to be used by the chatbot. Run the following command:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell script hljs" data-lang="shell script">ilab model download</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>The <code>ilab download</code> command is used to download the model to be used by the chatbot.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now, start the server that will be responsible for receiving the user input, sending it to the model, and sending the response back to the user. The <code>ilab model serve</code> command is used to start the server. Run the following command:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell script hljs" data-lang="shell script">ilab model serve</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>The <code>ilab model serve</code> command is used to start the server that will be responsible for receiving the user input, sending it to the model, and sending the response back to the user.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_public_skupper_deployment"><a class="anchor" href="#_public_skupper_deployment"></a>Public Skupper Deployment</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Deploy the public Skupper in Openshift Cluster. The public Skupper will receive the connection from the private Skupper and create a secure connection between the two sites.</p>
</div>
<div class="sect2">
<h3 id="_creating_the_project_and_deploying_the_public_skupper"><a class="anchor" href="#_creating_the_project_and_deploying_the_public_skupper"></a>Creating the project and deploying the public Skupper:</h3>
<div class="paragraph">
<p>This is the step where you create the project and deploy the public Skupper. The public Skupper will be responsible for receiving the connection from the private Skupper and creating a secure connection between the two sites. Open a new terminal and run the following commands:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell script hljs" data-lang="shell script">export SKUPPER_PLATFORM=kubernetes
oc new-project ilab-pilot
skupper init --enable-console --enable-flow-collector --console-user admin --console-password admin</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>Run this command in a new terminal and keep it open, because the default platform is <code>kubernetes</code> and the private terminal is using <code>podman</code>.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p><code>SKUPPER_PLATFORM=kubernetes</code> is used to set the platform to Kubernetes. This is necessary because the public Skupper will be running on a Kubernetes cluster.</p>
</li>
<li>
<p><code>oc new-project ilab-pilot</code> is used to create a new project called <code>ilab-pilot</code> in the OpenShift cluster.</p>
</li>
<li>
<p><code>skupper init</code> is used to initialize the Skupper network, setting up the necessary components to enable secure communication between services.</p>
</li>
<li>
<p>The <code>--enable-console</code> flag is used to enable the Skupper console, which provides a web interface for managing the Skupper network.</p>
</li>
<li>
<p>The <code>--enable-flow-collector</code> flag is used to enable the flow collector, which collects and displays information about the traffic flowing through the Skupper network.</p>
</li>
<li>
<p>The <code>--console-user admin</code> flag is used to set the username for the Skupper console to <code>admin</code>.</p>
</li>
<li>
<p>The <code>--console-password admin</code> flag is used to set the password for the Skupper console to <code>admin</code>.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_creating_the_token_to_allow_the_private_skupper_to_connect_to_the_public_skupper"><a class="anchor" href="#_creating_the_token_to_allow_the_private_skupper_to_connect_to_the_public_skupper"></a>Creating the token to allow the private Skupper to connect to the public Skupper:</h3>
<div class="paragraph">
<p>This is the step where you create the token to allow the private Skupper to connect to the public Skupper. At the same terminal, run the following command:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell script hljs" data-lang="shell script">skupper token create token.yaml</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p><code>skupper token create token.yaml</code> is used to generate a connection token that can be used by other sites to link to the Skupper network, ensuring secure communication.</p>
</li>
<li>
<p>The <code>token.yaml</code> file will contain the token to connect the two sites.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now, you&#8217;ll have a <code>token.yaml</code> file with the token to connect the two sites.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_private_skupper_deployment"><a class="anchor" href="#_private_skupper_deployment"></a>Private Skupper Deployment</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The second step is to deploy the private Skupper in Private Local Environment. The private Skupper will be responsible for creating a secure connection between the two sites, allowing the Ollama Pilot application to send requests to the InstructLab chat model.</p>
</div>
<div class="sect2">
<h3 id="_install_skupper"><a class="anchor" href="#_install_skupper"></a>Install Skupper</h3>
<div class="paragraph">
<p>To install skupper on site A, with podman as the platform, open a new terminal to handle all the commands related to the private Skupper. Here, we will create a skuper site using podman as the platform, we need to enable the podan service before running the skupper init command:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell script hljs" data-lang="shell script">systemctl --user enable --now podman.socket</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p><code>systemctl --user enable --now podman.socket</code> is used to enable and start the podman service at the user level.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now, run the following commands to install Skupper:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell script hljs" data-lang="shell script">export SKUPPER_PLATFORM=podman
skupper init --ingress none</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p><code>SKUPPER_PLATFORM=podman</code> is used to set the platform to podman. This is necessary because the private Skupper will be running on a podman container.</p>
</li>
<li>
<p><code>skupper init</code> is used to initialize the Skupper network, setting up the necessary components to enable secure communication between services.</p>
</li>
<li>
<p>The <code>--ingress none</code> flag is used to disable the automatic creation of an ingress controller. This is necessary because the public Skupper will be responsible for exposing the service to the internet.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_exposing_the_instructlab_chat_model"><a class="anchor" href="#_exposing_the_instructlab_chat_model"></a>Exposing the InstructLab Chat Model</h3>
<div class="paragraph">
<p>To bind the local service running the InstructLab chat model to the Skupper service:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell script hljs" data-lang="shell script">skupper expose host host.containers.internal --address instructlab --port 8000</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p><code>skupper expose</code> is used to expose a local service through the Skupper network, allowing it to be accessed from other Skupper-connected sites.</p>
</li>
<li>
<p><code>host.containers.internal</code> is used to bind the local service to the Skupper service.</p>
</li>
<li>
<p><code>--address instructlab</code> is used to specify the address of the service.</p>
</li>
<li>
<p><code>--port 8000</code> is used to specify the port of the service.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Check the status of the Skupper service:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell script hljs" data-lang="shell script">skupper service status

Services exposed through Skupper:
╰─ instructlab:8000 (tcp)</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p><code>skupper service status</code> is used to display the status of services exposed through Skupper, showing what is accessible and how it’s connected within the network.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_secure_communication_between_the_two_sites_with_skupper"><a class="anchor" href="#_secure_communication_between_the_two_sites_with_skupper"></a>Secure Communication Between the Two Sites with Skupper</h3>
<div class="paragraph">
<p>Now it&#8217;s time to establish a secure connection between the two sites using the token created by the public Skupper. Using the token created by the public Skupper, run the following command at the terminal where the private Skupper is running:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell script hljs" data-lang="shell script">skupper link create token.yaml --name instructlab</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p><code>skupper link create token.yaml --name instructlab</code> is used to establish a secure link between two Skupper sites using the token created by <code>skupper token</code>.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Check the status of the Skupper link:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell script hljs" data-lang="shell script">skupper link status

Links created from this site:

        Link instructlab is connected

Current links from other sites that are connected:

        There are no connected links</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p><code>skupper link status</code> is used to display the status of the links created by the Skupper network, showing which sites are connected and how they are connected.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Check the status on the public Skupper terminal:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell script hljs" data-lang="shell script">skupper link status

Links created from this site:

       There are no links configured or connected

Current links from other sites that are connected:

       Incoming link from site b8ad86d5-9680-4fea-9c07-ea7ee394e0bd</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p><code>skupper link status</code> is used to display the status of the links created by the Skupper network, showing which sites are connected and how they are connected.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_chatbot_with_protected_data"><a class="anchor" href="#_chatbot_with_protected_data"></a>Chatbot with Protected Data</h3>
<div class="paragraph">
<p>The last step is to expose the service in the public Skupper and create the Ollama Pilot application.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Still on the terminal where the <strong>public</strong> Skupper is running, run the following command to expose the service:</p>
</li>
</ul>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell script hljs" data-lang="shell script">skupper service create instructlab 8000</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p><code>skupper service create instructlab 8000</code> is used to create the service in the public Skupper, allowing it to be accessed from the private Skupper.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_deploying_instructlab_chatbot"><a class="anchor" href="#_deploying_instructlab_chatbot"></a>Deploying the InstructLab Chatbot</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before run the chatbot, let&#8217;s understand the final part of this solution, the Frontend application.</p>
</div>
<div class="paragraph">
<p>This application will be deployed in a OpenShift cluster, and will be responsible for sending the user input to the InstructLab chat model and displaying the response to the user. The application will be deployed at the same namespace where the public Skupper is running.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>The frontend application called ILAB Frontend chatbot will use the local service in the public cluster to send the user input to the InstructLab chat model and display the response to the user. See the line 23 of the <code>ilab-client-deployment.yaml</code> file.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_deploy_ilab_frontend_chatbot"><a class="anchor" href="#_deploy_ilab_frontend_chatbot"></a>Deploy ILAB Frontend chatbot</h3>
<div class="paragraph">
<p>To deploy the ILAB Frontend chatbot, lets use the following yaml deployment file, in this case the file is located at <code>~/instructlab/ilab-client-deployment.yaml</code>:</p>
</div>
<div class="listingblock source">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: apps.openshift.io/v1
kind: DeploymentConfig
metadata:
  name: ilab-client
spec:
  replicas: 1
  selector:
    app: ilab-client
  strategy:
    type: Recreate
  template:
    metadata:
      labels:
        app: ilab-client
    spec:
      containers:
      - name: ilab-client-container
        image: quay.io/rzago/ilab-client:latest
        ports:
        - containerPort: 5000
        env:
        - name: ADDRESS
          value: "http://instructlab:8000" # The address of the InstructLab chat model connected to the private Skupper
  triggers:
  - type: ConfigChange</code></pre>
</div>
</div>
<div class="paragraph">
<p>Apply the deployment file:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell script hljs" data-lang="shell script">oc apply -f ~/instructlab/ilab-client-deployment.yaml</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>The <code>ilab-client-deployment.yaml</code> file is used to deploy the ILAB Frontend chatbot, which will be responsible for sending the user input to the InstructLab chat model and displaying the response to the user.</p>
</li>
<li>
<p>The <code>ADDRESS</code> environment variable is used to specify the address of the InstructLab chat model connected to the private Skupper.</p>
</li>
<li>
<p>The <code>oc apply -f ~/instructlab/ilab-client-deployment.yaml</code> command is used to apply the deployment file and deploy the ILAB Frontend chatbot.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_creating_the_service_of_the_ilab_frontend_chatbot_deployment"><a class="anchor" href="#_creating_the_service_of_the_ilab_frontend_chatbot_deployment"></a>Creating the service of the ILAB Frontend chatbot deployment</h3>
<div class="paragraph">
<p>Now, let&#8217;s create the service for the ILAB Frontend chatbot deployment, the file is located at <code>~/instructlab/ilab-client-service.yaml</code>:</p>
</div>
<div class="listingblock source">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: v1
kind: Service
metadata:
  name: ilab-client-service
spec:
  selector:
    app: ilab-client
  ports:
  - protocol: TCP
    port: 5000
    targetPort: 5000</code></pre>
</div>
</div>
<div class="paragraph">
<p>Apply the service file:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell script hljs" data-lang="shell script">oc apply -f ~/instructlab/ilab-client-service.yaml</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>The <code>ilab-client-service.yaml</code> file is used to create the service for the ILAB Frontend chatbot deployment.</p>
</li>
<li>
<p>The <code>oc apply -f ~/instructlab/ilab-client-service.yaml</code> command is used to apply the service file and create the service for the ILAB Frontend chatbot deployment.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_exposing_the_service_of_the_ilab_frontend_chatbot_deployment"><a class="anchor" href="#_exposing_the_service_of_the_ilab_frontend_chatbot_deployment"></a>Exposing the service of the ILAB Frontend chatbot deployment</h3>
<div class="paragraph">
<p>We are almost there, now let&#8217;s expose the service of the ILAB Frontend chatbot deployment, the file is located at <code>~/instructlab/ilab-client-route.yaml</code>:</p>
</div>
<div class="listingblock source">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: route.openshift.io/v1
kind: Route
metadata:
  name: ilab-client-route
spec:
  to:
    kind: Service
    name: ilab-client-service
  port:
    targetPort: 5000</code></pre>
</div>
</div>
<div class="paragraph">
<p>Apply the route file:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell script hljs" data-lang="shell script">oc apply -f ~/instructlab/ilab-client-route.yaml</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>The <code>ilab-client-route.yaml</code> file is used to expose the service of the ILAB Frontend chatbot deployment.</p>
</li>
<li>
<p>The <code>oc apply -f ~/instructlab/ilab-client-route.yaml</code> command is used to apply the route file and expose the service of the ILAB Frontend chatbot deployment.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_accessing_the_ilab_frontend_chatbot"><a class="anchor" href="#_accessing_the_ilab_frontend_chatbot"></a>Accessing the ILAB Frontend chatbot</h3>
<div class="paragraph">
<p>Finally, to access the ILAB Frontend chatbot, you can use the following command to get the public URL:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell script hljs" data-lang="shell script">oc get route ilab-client-route</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>The <code>oc get route ilab-client-route</code> command is used to get the public URL of the ILAB Frontend chatbot, which will be used to access the chatbot from the Ollama Pilot application.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_interacting_with_the_chatbot"><a class="anchor" href="#_interacting_with_the_chatbot"></a>Interacting with the chatbot</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To interact with the chatbot, you can access the public URL of the ILAB Frontend chatbot using a web browser. The chatbot will be displayed on the screen, and you can start interacting with it by typing messages in the chat window.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/chat_bot.png" alt="Chatbot">
</div>
</div>
<div class="sect2">
<h3 id="_considerations"><a class="anchor" href="#_considerations"></a>Considerations</h3>
<div class="ulist">
<ul>
<li>
<p>If your machine has an Nvidia GPU, you can use the InstructLab chat model to generate responses to user input. The InstructLab chat model is a large language model trained on the Merlinite dataset and is capable of generating human-like responses to user input. By following the steps outlined in this demonstration, you can deploy the InstructLab chat model in your environment and interact with it using the ILAB Frontend chatbot. This will allow you to experience the power of generative AI models and see how they can be used to create engaging and interactive applications.</p>
</li>
<li>
<p>Adjust the model temperature to control the randomness of the responses generated by the chatbot. A lower temperature will result in more deterministic responses, while a higher temperature will result in more random responses. Experiment with different temperature values to find the right balance between coherence and creativity in the chatbot&#8217;s responses.</p>
</li>
<li>
<p>Image repository for ilab-client: <a href="https://github.com/rafaelvzago/ilab-client">rafaelvzago/ilab-client</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="02-architecture.html" class="query-params-link">2. Architecture</a></span>
  <span class="next"><a href="04-conclusion.html" class="query-params-link">4. Conclusion</a></span>
</nav>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <img
          src="../_/img/app-services-logo.png" height="40px" alt="Cloud Native Architecture Solution Patterns"  href="https://redhat.com" ></a>
</footer><script src="../_/js/vendor/clipboard.js"></script>
<script src="../_/js/site.js"></script>
<script async src="../_/js/vendor/highlight.js"></script>
  </body>
</html>
